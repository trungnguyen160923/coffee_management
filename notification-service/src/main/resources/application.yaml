server:
  port: ${SERVER_PORT:8006}
  servlet:
    context-path: ${SERVER_CONTEXT_PATH:/notification-service}

spring:
  config:
    import: optional:file:.env[.properties]
  application:
    name: notification-service
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/notification_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Ho_Chi_Minh}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO:update}
    show-sql: ${JPA_SHOW_SQL:true}
    properties:
      hibernate:
        format_sql: ${JPA_FORMAT_SQL:true}
    database-platform: ${JPA_DATABASE_PLATFORM:org.hibernate.dialect.MySQLDialect}
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9094}
    consumer:
      group-id: ${KAFKA_CONSUMER_GROUP:notification-service}
      auto-offset-reset: ${KAFKA_AUTO_OFFSET_RESET:earliest}
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: "com.service.notification_service.events"
        spring.json.use.type.headers: true
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
  mail:
    # ============================================
    # EMAIL CONFIGURATION
    # ============================================
    # Option 1: Brevo (Sendinblue) - RECOMMENDED for production
    # - Better deliverability and analytics
    # - Free tier: 300 emails/day
    # - Get SMTP credentials from: https://app.brevo.com/settings/keys/smtp
    # host: smtp-relay.brevo.com
    # port: 587
    # username: your_brevo_email@example.com  # Your Brevo account email
    # password: your_brevo_smtp_key           # SMTP key from Brevo dashboard
    
    # Option 2: Gmail SMTP - Simple but limited
    # - Free but has daily limits (500 emails/day)
    # - May have deliverability issues
    # - Need to enable "App Password" in Google Account settings
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:changeme@gmail.com}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: ${MAIL_SMTP_AUTH:true}
          starttls:
            enable: ${MAIL_SMTP_STARTTLS:true}
          ssl:
            trust: ${MAIL_SMTP_SSL_TRUST:smtp.gmail.com}

jwt:
  signerKey: "${JWT_SIGNER_KEY}"

jackson:
  serialization:
    write-dates-as-timestamps: ${JACKSON_WRITE_DATES_AS_TIMESTAMPS:false}
  deserialization:
    fail-on-unknown-properties: ${JACKSON_FAIL_ON_UNKNOWN:false}

app:
  cors:
    allowed-origins: ${APP_CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:8000,http://localhost:3000}
  services:
    auth: ${AUTH_SERVICE_URL:http://localhost:8001/auth-service}
    order: ${ORDER_SERVICE_URL:http://localhost:8002/order-service}
    profile: ${PROFILE_SERVICE_URL:http://localhost:8003/profiles}
    catalog: ${CATALOG_SERVICE_URL:http://localhost:8004/catalogs}
  kafka:
    topics:
      inventory-low-stock: ${TOPIC_INVENTORY_LOW_STOCK:inventory.low.stock}
      inventory-out-of-stock: ${TOPIC_INVENTORY_OUT_OF_STOCK:inventory.out.of.stock}
      order-created: ${TOPIC_ORDER_CREATED:order.created}
      order-completed: ${TOPIC_ORDER_COMPLETED:order.completed}
      order-cancelled: ${TOPIC_ORDER_CANCELLED:order.cancelled}
      reservation-created: ${TOPIC_RESERVATION_CREATED:reservation.created}
      reservation-confirmed: ${TOPIC_RESERVATION_CONFIRMED:reservation.confirmed}
      reservation-cancelled: ${TOPIC_RESERVATION_CANCELLED:reservation.cancelled}
      po-supplier-response: ${TOPIC_PO_SUPPLIER_RESPONSE:po.supplier.response}
